
number_procs 6

type st = M | S | I

weak array Cache[proc] : st

init (i) { Cache[i] = I }

(* unsafe (i j) { i@Cache[i] = M && j@Cache[j] <> I } *)

unsafe (i j) { j@Cache[j] = M && j@Cache[j] <> I }

(* unsafe (i j) { read(i, Cache[i]) = M && read(i, Cache[j]) <> I } *)
(* unsafe (i j) { read(j, Cache[j]) = M && read(i, Cache[j]) <> I } *)

transition read_miss ([i] j)
requires { Cache[j] <> M }
{ Cache[i] := S }
