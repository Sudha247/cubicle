
forbidden
CS CS * * * * ;
CS * CS * * * ;
CS * * CS * * ;
CS * * * CS * ;
CS * * * * CS ;
* CS CS * * * ;
* CS * CS * * ;
* CS * * CS * ;
* CS * * * CS ;
* * CS CS * * ;
* * CS * CS * ;
* * CS * * CS ;
* * * CS CS * ;
* * * CS * CS ;
* * * * CS CS

data
  lock = 1 : [-5:1] /* the real lower bound is -N, but the tool requires finite domains */

process (6)
registers
  $r = * : [-5:1]
text
  ACQ:  { read: $r := lock; write: lock := $r - 1 };
       if $r = 1 then goto CS;
  SPN: read: $r := lock;
       if $r = 1 then goto ACQ;
       goto SPN;
  CS:  nop;
  REL: write: lock := 1;
       goto ACQ