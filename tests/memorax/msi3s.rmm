forbidden
BAD * * *

data
  C1 = 0 : [0:2]
  C2 = 0 : [0:2]
  C3 = 0 : [0:2]

process
registers
  $rC1 = * : [0:2]
  $rC2 = * : [0:2]
  $rC3 = * : [0:2]
text
  L: locked {
       read: $rC1 := C1;
       read: $rC2 := C2;
       read: $rC3 := C3
     };
     if $rC1 = 2 && $rC2 != 0 || $rC1 != 0 && $rC2 = 2 ||
        $rC1 = 2 && $rC3 != 0 || $rC1 != 0 && $rC3 = 2 ||
        $rC2 = 2 && $rC3 != 0 || $rC2 != 0 && $rC3 = 2 then
       goto BAD;
     goto L;
  BAD : nop

process
text
  L: locked {
        read: C1 = 0; write: C1 := 1; read: C2 = 2; write: C2 := 1; read: C3 = 2; write: C3 := 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 2; write: C2 := 1; read: C3 = 0
     or read: C1 = 0; write: C1 := 1; read: C2 = 2; write: C2 := 1; read: C3 = 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 0; read: C3 = 2; write: C3 := 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 0; read: C3 = 0
     or read: C1 = 0; write: C1 := 1; read: C2 = 0; read: C3 = 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 1; read: C3 = 2; write: C3 := 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 1; read: C3 = 0
     or read: C1 = 0; write: C1 := 1; read: C2 = 1; read: C3 = 1
     or read: C1 = 0; write: C1 := 2; write: C2 := 0; write: C3 := 0
     or read: C1 = 1; write: C1 := 2; write: C2 := 0; write: C3 := 0
     };
     goto L

process
text
  L: locked {
        read: C2 = 0; write: C2 := 1; read: C1 = 2; write: C1 := 1; read: C3 = 2; write: C3 := 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 2; write: C1 := 1; read: C3 = 0
     or read: C2 = 0; write: C2 := 1; read: C1 = 2; write: C1 := 1; read: C3 = 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 0; read: C3 = 2; write: C3 := 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 0; read: C3 = 0
     or read: C2 = 0; write: C2 := 1; read: C1 = 0; read: C3 = 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 1; read: C3 = 2; write: C3 := 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 1; read: C3 = 0
     or read: C2 = 0; write: C2 := 1; read: C1 = 1; read: C3 = 1
     or read: C2 = 0; write: C2 := 2; write: C1 := 0; write: C3 := 0
     or read: C2 = 1; write: C2 := 2; write: C1 := 0; write: C3 := 0
     };
     goto L

process
text
  L: locked {
        read: C3 = 0; write: C3 := 1; read: C1 = 2; write: C1 := 1; read: C2 = 2; write: C2 := 1
     or read: C3 = 0; write: C3 := 1; read: C1 = 2; write: C1 := 1; read: C2 = 0
     or read: C3 = 0; write: C3 := 1; read: C1 = 2; write: C1 := 1; read: C2 = 1
     or read: C3 = 0; write: C3 := 1; read: C1 = 0; read: C2 = 2; write: C2 := 1
     or read: C3 = 0; write: C3 := 1; read: C1 = 0; read: C2 = 0
     or read: C3 = 0; write: C3 := 1; read: C1 = 0; read: C2 = 1
     or read: C3 = 0; write: C3 := 1; read: C1 = 1; read: C2 = 2; write: C2 := 1
     or read: C3 = 0; write: C3 := 1; read: C1 = 1; read: C2 = 0
     or read: C3 = 0; write: C3 := 1; read: C1 = 1; read: C2 = 1
     or read: C3 = 0; write: C3 := 2; write: C1 := 0; write: C2 := 0
     or read: C3 = 1; write: C3 := 2; write: C1 := 0; write: C2 := 0
     };
     goto L
