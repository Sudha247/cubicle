
forbidden
CS CS

data
  x  = * : [0:2]
  y  = * : [0:2]

process
registers
  $rx = * : [0:2]
  $ry = * : [0:2]
text
  L0: locked write: x := 1;
      read: $ry := y;
      if $ry != 0 then 
        goto L0;
      locked write: y := 1;
      read: $rx := x;
      if $rx != 1 then {
        read: $ry := y;
        if $ry != 1 then
          goto L0;
	assume: false
      };
      goto CS;
  CS: 
      write: y := 0;
      goto L0

process
registers
  $rx = * : [0:2]
  $ry = * : [0:2]
text
  L0: locked write: x := 2;
      read: $ry := y;
      if $ry != 0 then
        goto L0;
      locked write: y := 2;
      read: $rx := x;
      if $rx != 2 then {
        read: $ry := y;
        if $ry != 2 then
          goto L0;
	assume: false
      };
      goto CS;
  CS:
      write: y := 0;
      goto L0
