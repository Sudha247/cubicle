
forbidden
CS CS

data
  lock = 1 : [-1:1] /* the real lower bound is -N, but the tool requires finite domains */

process (2)
registers
  $r = * : [-1:1]
text
  ACQ: locked { read: $r := lock; write: lock := $r - 1 };
       if $r = 1 then goto CS;
  SPN: read: $r := lock;
       if $r = 1 then goto ACQ;
       goto SPN;
  CS:  nop;
  REL: write: lock := 1;
       goto ACQ