forbidden
BAD * *

data
  C1 = 0 : [0:2]
  C2 = 0 : [0:2]

process
registers
  $rC1 = * : [0:2]
  $rC2 = * : [0:2]
text
  L: locked {
       read: $rC1 := C1;
       read: $rC2 := C2
     };
     if $rC1 = 2 && $rC2 != 0 || $rC1 != 0 && $rC2 = 2 then
       goto BAD;
     goto L;
  BAD : nop

process
text
  L: locked {
        read: C1 = 0; write: C1 := 1; read: C2 = 2; write: C2 := 1
     or read: C1 = 0; write: C1 := 1; read: C2 = 0
     or read: C1 = 0; write: C1 := 1; read: C2 = 1
     or read: C1 = 0; write: C1 := 2; write: C2 := 0
     or read: C1 = 1; write: C1 := 2; write: C2 := 0
     };
     goto L

process
text
  L: locked {
        read: C2 = 0; write: C2 := 1; read: C1 = 2; write: C1 := 1
     or read: C2 = 0; write: C2 := 1; read: C1 = 0
     or read: C2 = 0; write: C2 := 1; read: C1 = 1
     or read: C2 = 0; write: C2 := 2; write: C1 := 0
     or read: C2 = 1; write: C2 := 2; write: C1 := 0
     };
     goto L
