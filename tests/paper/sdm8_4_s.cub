
(* Example 8-4. Loads Are not Reordered with Older Stores to the Same Location*)

number_procs 1

type loc = L1 | L2 | End

array PC[proc] : loc

array EAX[proc] : int

weak var X : int

init (p) { PC[p] = L1 && EAX[p] = 0 && X = 0 }

(* FORBIDDEN Final State *)
unsafe (p) { p = #1 && PC[p] = End && EAX[p] <> 1 }

(* REQUIRED Final State *)
(* unsafe (p) { p = #1 && PC[p] = End && EAX[p] = 1 } *)

transition t1_1 (p)
requires { p = #1 && PC[p] = L1 }
{ PC[p] := L2; write(p, X, 1) }

transition t1_2 (p)
requires { p = #1 && PC[p] = L2 }
{ PC[p] := End; EAX[p] := read(p, X) }
