
# Memory layout:
# 0 — flag[0]
# 1 — flag[1]
# 2 — flag[2]
# 3 — turn

thread t0
initial q0
final enter
transition	q0	q1	write	1	0
transition	q1	q2_f	write	1	3
transition	q1	q2_f	write	2	3
transition	q2_f	q2	mfence
transition	q2	q3	read	flag1	1
transition	q3	q4	read	flag2	2
transition	q4	q5	read	turn	3
transition	q5	q2	check	&& || == flag1 1 == flag2 1 != turn 0
transition	q5	enter	check	|| && == flag1 0 == flag2 0 == turn 0
transition	enter	q0	write	0	0
end

thread t1
initial q0
final enter
transition	q0	q1	write	1	1
transition	q1	q2_f	write	0	3
transition	q1	q2_f	write	2	3
transition	q2_f	q2	mfence
transition	q2	q3	read	flag0	0
transition	q3	q4	read	flag2	2
transition	q4	q5	read	turn	3
transition	q5	q2	check	&& || == flag0 1 == flag2 1 != turn 1
transition	q5	enter	check	|| && == flag0 0 == flag2 0 == turn 1
transition	enter	q0	write	0	1
end

thread t2
initial q0
final enter
transition	q0	q1	write	1	2
transition	q1	q2_f	write	0	3
transition	q1	q2_f	write	1	3
transition	q2_f	q2	mfence
transition	q2	q3	read	flag0	0
transition	q3	q4	read	flag1	1
transition	q4	q5	read	turn	3
transition	q5	q2	check	&& || == flag0 1 == flag1 1 != turn 2
transition	q5	enter	check	|| && == flag0 0 == flag1 0 == turn 2
transition	enter	q0	write	0	2
end
